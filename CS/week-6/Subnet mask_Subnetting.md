# Network | 서브넷 마스크와 서브네팅

> 사전 지식 참고 자료 - [지식나눔 블로그 : IP 주소 체계와 클래스 구별법 (IPV4)](http://korean-daeddo.blogspot.com/2015/12/ip.html) 



## 1. 서브넷

IPv4는 이론적으로 43억 개의 IP 주소를 가질 수 있다. 하지만  43억개를 각 네트워크 영역마다 아무렇게나 둘 수 없다는 문제를 가진다.

A 클래스의 경우를 예로 들면 A 클래스는 하나의 네트워크에 16,777,214(2^24)개의 호스트에 IP를 할당할 수 있어서 큰 규모의 국제 기업이나 단체가 아닌 곳에서 사용하는 것은 매우 비효율적이다. 만약 네트워크 장치 4개를 가진 가정집에서 A 클래스를 사용할 경우 네트워크 주소와 브로드캐스트 주소까지 포함해서 총 6개의 IP만 사용되고 나머지 16,777,208개는 사용되지 않은 채 낭비될 것이다. 

> 이런 문제를 해결하기 위해서 **IP를 사용하는 네트워크 장치들의 수에 따라 네트워크를 효율적으로 사용할 수 있도록 서브넷(Subnet)이 등장하게 되었다.**

### 네트워크 주소와 브로드캐스트 주소

- 네트워크 주소(Network Address)
  - 하나의 네트워크를 통칭하기 위한 주소로 해당 네트워크의 첫 번째 IP 주소가 네트워크 주소이다.

- 브로드캐스트 주소(Broadcast Address)
  - 특정 네트워크에 속하는 모든 호스트가 갖게 되는 주소로, 네트워크에 있는 모든 클라이언트들에게 데이터를 보내기 위함이다.
  - 해당 네트워크에 속하는 모든 IP 주소 가운데 마지막 IP주소가 브로드캐스트 주소이다.



## 2. 서브넷 마스크

> 서브넷 마스크는 IP 주소 체계의 네트워크 아이디(Network ID)와 호스트 아이디(Host ID)를 서브넷 마스크를 통해 변경해서 네트워크 영역을 분리 또는 합체시키는 개념이다.
>
> - 네트워크를 분리하는 것을 서브네팅(Subnetting), 네트워크를 합치는 것을 슈퍼넷팅(Suppernetting)이라고 한다.

- 서브넷 마스크는 IP 주소와 동일하게 32bit 2진수로 되어 있으며 8bit마다 닷(.)으로 구분된다.
- **서브넷 마스크가 1인 부분은 네트워크 아이디이고, 0인 부분은 호스트 아이디이다.**
- 0으로 된 부분에서 IP를 나눠서 쓰는 혹은 IP를 쪼개서 쓰는 개념이다.



IP 주소 뒤에 `/24` 같은 것들을 본 적이 있을 것이다. 이것은 Prefix(접두어)로 서브넷 마스크의 bit 수를 의미한다. `192.168.0.3/24`일 경우 IP 주소는 `192.168.0.3`이고 서브넷 마스크가 `255.255.255.0`이다.

| **클래스** | **서브넷 마스크**                       | **표기법**           |
| ---------- | --------------------------------------- | -------------------- |
| A          | **11111111**.00000000.00000000.00000000 | /8 or 255.0.0.0      |
| B          | **11111111.11111111**.00000000.00000000 | /16 or 255.255.0.0   |
| C          | **11111111.11111111.11111111**.00000000 | /24 or 255.255.255.0 |



## 3. 서브넷팅

> IP 주소 고갈 문제를 해결하기 위해 원본 네트워크를 여러 개의 네트워크로 분리하는 과정이다.
>
> - 서브넷팅을 통해 Network ID가 확장되기 때문에 할당할 수 있는 네트워크의 수가 늘어나게 된다.

![Subnetting](https://raw.githubusercontent.com/soo5717/Typora-image/velog/img/Subnetting.png)

### 서브넷팅 계산

Host ID를 Network ID로 변환하기 위해 1bit씩 가져올 때마다 네트워크의 크기는 2의 배수로 증가하고 호스트의 수는 2로 나누어지게 된다. 

| **Bitmask (서브넷 마스크로 사용된 1의 개수)** | **Netmask(255.255.255.x)** | **네트워크 수 (서브넷 개수)** | **호스트 수** |
| --------------------------------------------- | -------------------------- | ----------------------------- | ------------- |
| /25                                           | 128                        | 2                             | 128           |
| /26                                           | 192                        | 4                             | 64            |
| /27                                           | 224                        | 8                             | 32            |
| /28                                           | 240                        | 16                            | 16            |
| /29                                           | 248                        | 32                            | 8             |
| /30                                           | 252                        | 64                            | 4             |
| /31                                           | 254                        | 128                           | 2             |
| /32(Host Rount)                               | 255                        | 256                           | 1             |

194.139.10.0/26의 경우 서브넷 마스크가 26bit이기 때문에 255.255.255.192가 된다. Network ID와 Host ID가 아래 표와 같이 구성되어 있으면 Host ID에서 2bit를 이용해 2^2개의 서브넷으로 분할 할 수 있다.

|                   | **Network ID** | **Network ID** | **Network ID** | **Host ID**  |
| ----------------- | -------------- | -------------- | -------------- | ------------ |
| **10진수**        | 194            | 139            | 10             | 0            |
| **2진수**         | 11000010       | 10001011       | 00001010       | **00**000000 |
| **서브넷 마스크** | 11111111       | 11111111       | 11111111       | **11**000000 |

각각의 Subnet ID를 제외한 Host ID를 0으로 변경하여 Network ID를 도출해낼 수 있다.

| **Network ID** | **Host ID** | **Host ID** | **도출된 Network ID** |
| -------------- | ----------- | ----------- | --------------------- |
| 194.139.10     | 00          | 0000        | 194.139.10.0          |
| 194.139.10     | 01          | 0000        | 194.139.10.64         |
| 194.139.10     | 10          | 0000        | 194.139.10.128        |
| 194.139.10     | 11          | 0000        | 194.139.10.192        |

**호스트에 할당 가능한  IP의 범위는 [0~63], [64~127], [128~191], [192~255]**로 가능하며, **네트워크는 [194.139.10.0], [194.139.10.64], [194.139.10.128], [194.139.10.192] 총 4개로 나누어지게 된다.** 

**각 네트워크를 구분할 때는 각 범위의 가장 첫 번째 IP를 사용하고 이를 네트워크 주소**라고 부른다. **각 범위의 가장 마지막 IP 주소는 브로드캐스트 주소가 된다.** 따라서 194.139.10.123는 194.168.10.64/26(네트워크 주소) 네트워크에 속하게 되며, 서브넷팅 된 3개의 다른 네트워크와는 라우터를 통하여서만 통신할 수 있다.

| **IP 주소**                     | **구분**            |
| ------------------------------- | ------------------- |
| **194.139.10.0/26**             | **Network Address** |
| 194.139.10.1 ~ 194.139.10.62    | Host IP             |
| 194.139.10.63                   | Broadcast Address   |
| **194.139.10.64/26**            | **Network Address** |
| 194.139.10.65 ~ 194.139.10.126  | Host IP             |
| 194. 139.10.127                 | Broadcast Address   |
| **194.139.10.128/26**           | **Network Address** |
| 194.139.10.129 ~ 194.139.10.190 | Host IP             |
| 194. 139.10.191                 | Broadcast Address   |
| **194.139.10.192/26**           | **Network Address** |
| 194.139.10.193 ~ 194.139.10.254 | Host IP             |
| 194. 139.10.255                 | Broadcast Address   |